#
# /opt/bro/etc/node.cfg
#
# Generated by Chef for <%= node[:fqdn] %>
#


# This is a complete standalone configuration.  Most likely you will
# only need to change the interface.
#[bro]
#type=standalone
#host=localhost
#interface=eth0


## Below is an example clustered configuration. If you use this,
## remove the [bro] node above.

[manager]
type=manager
host=localhost

[proxy]
type=proxy
host=localhost

<% for @sniff in @sniffing_interfaces %>
[<%= @sniff[:sensorname] %>]
type=worker
host=localhost
interface=<%= @sniff[:interface] %>
lb_method=pf_ring
lb_procs=<%= @sniff[:bro_lb_procs] %>
<% if @sniff[:bro_numa_tune] %>
pin_cpus=<%= (@sniff[:bro_numa_cpu_start]..@sniff[:bro_numa_cpu_start]+@sniff[:bro_lb_procs]+1).to_a.join(",") %>
<% end %>
aux_scripts=networks/<%= @sniff[:sensorname] %>

<% end %>
