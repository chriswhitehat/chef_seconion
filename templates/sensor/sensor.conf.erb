#
# /etc/nsm/<%= @sniff[:sensorname] %>/sensor.conf
#
# Generated by Chef for <%= node[:fqdn] %>
#
SENSOR_NAME="<%= @sniff[:sensorname] %>"

SENSOR_INTERFACE="<%= @sniff[:interface] %>"
SENSOR_INTERFACE_AUTO="N"
SENSOR_NET_GROUP="<%= @sniff[:sensor_net_group] %>"

SENSOR_SERVER_HOST="<%= @node[:seconion][:server][:servername] %>"
SENSOR_SERVER_PORT="7736"
SENSOR_BARNYARD2_PORT="<%= @barnyard_port %>"

SENSOR_USER="sguil"
SENSOR_GROUP="sguil"
SENSOR_LOG_DIR="/nsm/sensor_data/<%= @sniff[:sensorname] %>"
SENSOR_VLAN_TAGGING="N"
SENSOR_AUTO="Y"
SENSOR_UTC="Y"

PCAP_AGENT_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/pcap_agent.conf"
SANCP_AGENT_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/sancp_agent.conf"
SNORT_AGENT_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/snort_agent.conf"
SNORT_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/snort.conf"
SNORT_OPTIONS=""
BARNYARD2_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/barnyard2.conf"
BARNYARD2_WALDO="/etc/nsm/<%= @sniff[:sensorname] %>/barnyard2.waldo"
BARNYARD2_OPTIONS=""
SANCP_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/sancp.conf"
SANCP_OPTIONS=""
PADS_AGENT_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/pads_agent.conf"
PADS_CONFIG="/etc/nsm/<%= @sniff[:sensorname] %>/pads.conf"
PADS_OPTIONS=""

PCAP_OPTIONS=<%= @sniff[:pcap_options] %>
PCAP_SIZE=<%= @sniff[:pcap_size] %>MiB
PCAP_RING_SIZE=<%= @sniff[:pcap_ring_size] %>MiB
IDS_LB_PROCS=<%= @sniff[:ids_lb_procs] %>

<% if @sniff[:pcap_enabled] %>
PCAP_ENABLED="yes"
<% else %>
PCAP_ENABLED="no"
<% end %>

<% if @sniff[:pcap_agent_enabled] %>
PCAP_AGENT_ENABLED="yes"
<% else %>
PCAP_AGENT_ENABLED="no"
<% end %>

<% if @sniff[:snort_agent_enabled] %>
SNORT_AGENT_ENABLED="yes"
<% else %>
SNORT_AGENT_ENABLED="no"
<% end %>

<% if @sniff[:ids_engine_enabled] %>
IDS_ENGINE_ENABLED="yes"
<% else %>
IDS_ENGINE_ENABLED="no"
<% end %>

<% if @sniff[:barnyard2_enabled] %>
BARNYARD2_ENABLED="yes"
<% else %>
BARNYARD2_ENABLED="no"
<% end %>

<% if @sniff[:prads_enabled] %>
PRADS_ENABLED="yes"
<% else %>
PRADS_ENABLED="no"
<% end %>

<% if @sniff[:sancp_agent_enabled] %>
SANCP_AGENT_ENABLED="yes"
<% else %>
SANCP_AGENT_ENABLED="no"
<% end %>

<% if @sniff[:pads_agent_enabled] %>
PADS_AGENT_ENABLED="yes"
<% else %>
PADS_AGENT_ENABLED="no"
<% end %>

<% if @sniff[:argus_enabled] %>
ARGUS_ENABLED="yes"
<% else %>
ARGUS_ENABLED="no"
<% end %>

<% if @sniff[:http_agent_enabled] %>
HTTP_AGENT_ENABLED="yes"
<% else %>
HTTP_AGENT_ENABLED="no"
<% end %>
